<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>자격증 선택</title>
    <style>
      body {
        margin: 0;
        font-family: "Pretendard", Arial, sans-serif;
        background: linear-gradient(to bottom right, #eaf6ff, #ffffff);
        overflow-x: hidden;
        overflow-y: hidden; /* ✅ 추가: 스크롤 방지 */
        min-height: 100vh;
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 40px;
      }

      .logo {
        height: 52px;
      }

      .nav-menu {
        display: flex;
        gap: 2px;
        align-items: center;
        font-weight: 500;
        font-size: 18px;
        color: #1e1e1e;
      }

      .nav-menu span,
      .nav-menu .profile-icon {
        padding: 0 16px;
        position: relative;
        display: flex;
        align-items: center;
      }

      .nav-menu span:not(:first-child)::before,
      .nav-menu .profile-icon::before {
        content: "";
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 1px;
        height: 24px;
        background-color: #ccc;
      }

      .top-message {
        display: none;
        padding: 30px 60px 0 60px;
        font-size: 24px;
        font-weight: 500;
        color: #000000;
        line-height: 1.6;
      }

      .top-message strong {
        color: #007aff;
      }

      .main-wrapper {
        display: flex;
        justify-content: center;
        gap: 40px;
        padding: 40px 40px 60px;
      }

      .left-panel {
        background: linear-gradient(180deg, #f8fbfe 0%, #f1f6fa 100%);
        border-radius: 20px;
        padding: 40px;
        width: 1151px;
        min-height: 400px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        transition: height 0.3s ease;
      }

      .intro-box {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
        text-align: center;
        gap: 20px;
      }

      .intro-box img {
        width: 120px;
      }

      .speech {
        background: #fff;
        padding: 24px;
        border-radius: 15px;
        font-size: 30px;
        font-weight: 400;
        line-height: 1.6;
        box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.05);
      }

      .community-list {
        display: none;
        flex-direction: column;
        gap: 30px;
      }

      .community-box {
        background: #fff;
        border-radius: 10px;
        padding: 24px;
        box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.1);
      }

      .community-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 20px;
        font-weight: 600;
        color: #222;
        margin-bottom: 12px;
      }

      .community-title {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 36px;
        font-weight: 600;
      }

      .community-posts {
        font-size: 20px;
        font-weight: 400;
        line-height: 1.5;
        color: #444;
        margin-left: 34px;
      }

      .exam-selector {
        background: #f8fafd;
        border-radius: 20px;
        padding: 30px;
        width: 480px;
        height: 930px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        overflow-y: auto;
      }

      .exam-selector h2 {
        font-size: 24px;
        font-weight: 700;
        color: #1e3a8a;
        margin-bottom: 4px;
      }

      .exam-selector small {
        display: block;
        font-size: 16px;
        margin-bottom: 20px;
        color: #666;
      }

      details {
        margin-top: 10px;
        border-radius: 12px;
        overflow: hidden;
        background: #ffffff;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        border-left: 8px solid #007aff;
      }

      summary {
        font-size: 18px;
        font-weight: 600;
        background: #ffffff;
        padding: 16px 20px;
        cursor: pointer;
        list-style: none;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      summary::-webkit-details-marker {
        display: none;
      }

      summary::after {
        content: "▾";
        font-size: 16px;
        color: #007aff;
      }

      ul {
        list-style: none;
        padding: 0 20px 10px 20px;
        margin: 0;
      }

      li {
        padding: 10px;
        border-radius: 8px;
        transition: background 0.2s;
        display: flex;
        align-items: center;
      }

      li:hover {
        background-color: #f0f7ff;
      }

      input[type="checkbox"] {
        accent-color: #007aff;
        margin-right: 8px;
      }

      .community-header a,
      .community-posts a {
        color: #444;
        text-decoration: none;
        display: block;
        margin-bottom: 4px;
      }

      .community-posts a:last-child {
        margin-bottom: 0;
      }

      .community-header a:hover,
      .community-posts a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <header>
      <img src="tutti.png" alt="Tutti Logo" class="logo" />
      <div class="nav-menu">
        <span onclick="window.location.reload()">홈</span>
        <span onclick="alert('알림 기능은 추후 구현 예정입니다.')">알림</span>
        <span class="profile-icon">
          <img src="icons/profile.png" alt="profile" width="37" />
        </span>
      </div>
    </header>

    <div class="top-message" id="top-message">
      <p>
        <strong>“삼삼옥수”</strong> 님의 버킷리스트가 완성되었습니다!<br />
        앞으로의 시간, 당신이 주인공이에요.
      </p>
    </div>

    <div class="main-wrapper">
      <div class="left-panel" id="left-panel">
        <div class="intro-box" id="intro-box">
          <img src="icons/profile.png" alt="user" />
          <div class="speech">
            <strong>“삼삼옥수”</strong>님, 아직 참여한 커뮤니티가 없습니다.<br />
            관심 있는 자격증을 선택해, 함께 공부할 친구들을 만나보세요!
          </div>
        </div>

        <div class="community-list" id="community-list"></div>
      </div>

      <div class="exam-selector">
        <h2>✔ 공부할 자격증을 선택해주세요!</h2>
        <small>자격증은 3개까지 선택할 수 있어요.</small>
        <div id="exam-container"></div>
      </div>
    </div>

    <script>
      const mockExamData = [
        { category: "어학", exams: ["TOEIC", "TOEFL", "OPIC"] },
        {
          category: "IT·정보통신",
          exams: ["정보처리기사", "컴퓨터활용능력", "SQLD", "GTQ"],
        },
        {
          category: "경영·사무·금융",
          exams: ["회계관리", "전산세무", "ERP정보관리사"],
        },
        {
          category: "교육·사회복지·상담",
          exams: ["보육교사", "사회복지사", "청소년상담사"],
        },
        {
          category: "디자인·문화·미디어",
          exams: ["GTQ", "멀티미디어콘텐츠제작전문가"],
        },
      ];

      document.addEventListener("DOMContentLoaded", () => {
        renderCategories(mockExamData);
      });

      function renderCategories(categories) {
        const container = document.getElementById("exam-container");
        const communityList = document.getElementById("community-list");
        const introBox = document.getElementById("intro-box");
        const topMessage = document.getElementById("top-message");
        const leftPanel = document.getElementById("left-panel");

        container.innerHTML = "";
        let selected = JSON.parse(localStorage.getItem("selectedExams")) || [];

        categories.forEach((cat) => {
          const details = document.createElement("details");
          const summary = document.createElement("summary");
          summary.textContent = cat.category;
          details.appendChild(summary);

          const ul = document.createElement("ul");

          cat.exams.forEach((exam) => {
            const li = document.createElement("li");
            const label = document.createElement("label");
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.value = exam;

            if (selected.includes(exam)) {
              checkbox.checked = true;
            }

            checkbox.addEventListener("change", () => {
              if (checkbox.checked) {
                if (selected.length >= 3) {
                  checkbox.checked = false;
                  alert("최대 3개까지 선택할 수 있습니다.");
                } else {
                  selected.push(exam);
                }
              } else {
                selected = selected.filter((e) => e !== exam);
              }

              localStorage.setItem("selectedExams", JSON.stringify(selected));
              updateDisabling();
              updateCommunityUI();
            });

            label.appendChild(checkbox);
            label.append(" " + exam);
            li.appendChild(label);
            ul.appendChild(li);
          });

          details.appendChild(ul);
          container.appendChild(details);
        });

        function updateDisabling() {
          const allCheckboxes = document.querySelectorAll(
            "input[type=checkbox]"
          );
          allCheckboxes.forEach((cb) => {
            if (!cb.checked && selected.length >= 3) {
              cb.disabled = true;
            } else {
              cb.disabled = false;
            }
          });
        }

        function updateCommunityUI() {
          const selectedCount = selected.length;

          if (selectedCount > 0) {
            introBox.style.display = "none";
            communityList.style.display = "flex";
            topMessage.style.display = "block";
            communityList.innerHTML = "";

            selected.forEach((exam) => {
              const box = document.createElement("div");
              box.className = "community-box";
              box.innerHTML = `
                <div class="community-header">
                  <a href="/community/${encodeURIComponent(exam)}">
                    <div class="community-title">
                       <img src="icons/award.png" alt="📢" width="42" height="40" />

                      ${exam} 커뮤니티
                    </div>
                  </a>
                  <span style="font-size: 14px; color: #888;">📅 2025.06.24</span>
                </div>
                <div class="community-posts">
                  <a href="/community/${encodeURIComponent(
                    exam
                  )}/post1">이 자격증의 최신 공부법은?</a>
                  <a href="/community/${encodeURIComponent(
                    exam
                  )}/post2">실전 대비 꿀팁 나눠요!</a>
                  <a href="/community/${encodeURIComponent(
                    exam
                  )}/post3">질문 있어요~</a>
                </div>
              `;
              communityList.appendChild(box);
            });

            const heightPerItem = 170;
            const paddingOffset = 160;
            const totalHeight = selectedCount * heightPerItem + paddingOffset;
            leftPanel.style.height = `${totalHeight}px`;
          } else {
            introBox.style.display = "flex";
            communityList.style.display = "none";
            topMessage.style.display = "none";
            leftPanel.style.height = "680px";
          }
        }

        updateDisabling();
        updateCommunityUI();
      }
    </script>
  </body>
</html>
